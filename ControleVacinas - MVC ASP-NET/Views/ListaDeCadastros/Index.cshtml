@model List<ListaDeCadastrosModel>
@{
    ViewData["Title"] = "Lista de cadastros";
    int id_manual = 1;
}

<div class="text-center">   
    @if(TempData["MensagemSucesso"] != null)
    {
        <div id="alert-box" class="alert alert-success custom-alert" role="alert">
            <button type="button" class="btn btn-danger btn-sm close-alert" arial-label="Close">x</button>
            @TempData["MensagemSucesso"]
        </div>
    }

    @if (TempData["MensagemErro"] != null)
    {
        <div id="alert-box" class="alert alert-danger custom-alert" role="alert">
            <button type="button" class="btn btn-danger btn-sm close-alert" arial-label="Close">x</button>
            @TempData["MensagemErro"]
        </div>
    }
</div>

<div class="titulo-index-cadastro-container">
    <div>LISTA DE VACINAÇÃO DOS SERVIDORES</div>

    <div class="botoes-index-cadastro-container">
        <a class="btn btn-primary d-flex align-items-center me-2" role="button" asp-controller="ListaDeCadastros" asp-action="Cadastrar" title="Adicionar Novo Cadastro">
            <i class="bi bi-person-plus"></i>Cadastrar
        </a>
        <a class="btn btn-success d-flex align-items-center me-2" role="button" asp-controller="ListaDeCadastros" asp-action="VisualizarRelatorio" title="Vizualizar Relatório em PDF" target="_blank">
            @* GerarRelatorio *@ @* VisualizarRelatorio *@
            <i class="bi bi-filetype-pdf"></i>Relatório
        </a>
    </div>
</div>

<div class="balanco-servidores-container">
    <!-- Título -->
    <div class="titulo-balanco-servidores-container">BALANÇO DOS SERVIDORES</div>

    <!-- Conteúdo -->
    <div class="conteudo-balanco-servidores-container">
        <div class="balanco-item">
            <div>Total de Servidores</div>
            <div class="balanco-numero total-servidores">@ViewBag.totalServidoresCadastrados</div>
        </div>

        <div class="balanco-item">
            <div>Vacinados Completamente</div>
            <div class="balanco-numero vacinados-completamente">@ViewBag.totalVacinadosCompletamente</div>
        </div>

        <div class="balanco-item">
            <div>Vacinados Parcialmente</div>
            <div class="balanco-numero vacinados-parcialmente">@ViewBag.totalVacinadosParcialmente</div>
        </div>

        <div class="balanco-item">
            <div>Não Vacinados</div>
            <div class="balanco-numero nao-vacinados">@ViewBag.totalNaoVacinados</div>
        </div>
    </div>
</div>

<div class="tabela-ListaDeCadastros-container">
    <table class="table table-striped table-hover table-bordered table-sm table-responsive" id="TabelaListaDeCadastros">
        <thead class="table-header">
            <tr>
                @*<th colspan="8" scope="col">Servidor ativo</th>*@
                <th colspan="2" scope="col"></th>
                <th colspan="2" scope="col">Servidor Ativo</th>
                <th colspan="3" scope="col"></th>
                <th colspan="4" scope="col">Hepatite B (HB)</th>
                <th colspan="2" scope="col">Anti-HBS</th>
                <th colspan="4" scope="col">Difteria e Tétano (DF)</th>
                <th colspan="2" scope="col">Tríplice Viral</th>
                <th colspan="5" scope="col">Covid-19</th>
                <th colspan="1" scope="col">Febre Amarela</th>
                <th colspan="1" scope="col">Influenza</th>
                <th colspan="1" scope="col"></th>
            </tr>
            <tr>
                <th scope="col">Ação</th>
                <th scope="col">#</th>
                <th scope="col">Matricula</th>
                <th scope="col">Nome</th>

                 <th scope="col">DT Nascimento</th> 

                <th scope="col">Setor</th>

                <th scope="col">Cargo</th>

                <th scope="col">DT 1ªDose</th>
                <th scope="col">DT 2ªDose</th>
                <th scope="col">DT 3ªDose</th>
                <th scope="col">DT Reforço</th>
                
                <th scope="col">DT Exame</th>
                <th scope="col">Resultado</th>
                
                <th scope="col">DT 1ªDose</th>
                <th scope="col">DT 2ªDose</th>
                <th scope="col">DT 3ªDose</th>
                <th scope="col">DT Reforço</th>
                
                <th scope="col">DT 1ªDose</th>
                <th scope="col">DT 2ªDose</th>
                
                <th scope="col">DT 1ªDose</th>
                <th scope="col">DT 2ªDose</th>
                <th scope="col">DT 3ªDose</th>
                <th scope="col">DT 1ªReforço</th>
                <th scope="col">DT 2ªReforço</th>
                
                <th scope="col">DT Dose Única</th>

                <th scope="col">DT Dose Anual</th>   
                
                <th scope="col">Situação Vacinação</th>

            </tr>
        </thead>
        
        <tbody class="table-group-divider">
            @if(Model !=null && Model.Any())
            {
                foreach (ListaDeCadastrosModel listaDeCadastrosModel in Model)
                {
                    <tr>
                        <td>
                            <a role="button" asp-route-id="@listaDeCadastrosModel.Id" asp-controller="ListaDeCadastros" asp-action="Editar" title="Editar cadastro" style="display: inline-block;">
                                <i class="bi bi-pencil-fill" style="color: black; margin-right: 5px;"></i>
                            </a>
                            <a role="button" asp-route-id="@listaDeCadastrosModel.Id" asp-controller="ListaDeCadastros" asp-action="ApagarConfirmacao" title="Apagar cadastro">
                                <i class="bi bi-trash3" style="color: black;"></i>
                            </a>
                        </td>

                        <td>@id_manual</td> @*Mostra o ID recalculado*@
                        @*<td>@listaDeCadastrosModel.Id</td>*@
                        <td>@listaDeCadastrosModel.NumMatricula</td>
                        <td>@listaDeCadastrosModel.Nome</td>
                         <td>@listaDeCadastrosModel.DataNascimento.ToString("dd/MM/yyyy")</td>

                        @* <td>
                            @listaDeCadastrosModel.DataNascimento.ToString("dd/MM/yyyy")<br />
                            <span>
                                @(DateTime.Now.Year - listaDeCadastrosModel.DataNascimento.Year
                                    - (DateTime.Now.DayOfYear < listaDeCadastrosModel.DataNascimento.DayOfYear ? 1 : 0)) anos
                            </span>
                        </td> *@

@*                         <td data-nascimento="@listaDeCadastrosModel.DataNascimento.ToString("yyyy-MM-dd")">
                            @listaDeCadastrosModel.DataNascimento.ToString("dd/MM/yyyy")
                        </td> *@
                        <td>@listaDeCadastrosModel.Setor</td>
                        <td>@listaDeCadastrosModel.Cargo</td>
                        <td>@listaDeCadastrosModel.DataDose1HepatiteB?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose2HepatiteB?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose3HepatiteB?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDoseReforcoHepatiteB?.ToString("dd/MM/yyyy")</td>

                        <td>@listaDeCadastrosModel.DataExameAntiHBS?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.ResultadoExameAntiHBS</td>

                        <td>@listaDeCadastrosModel.DataDose1DifteriaTetano?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose2DifteriaTetano?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose3DifteriaTetano?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDoseReforcoDifteriaTetano?.ToString("dd/MM/yyyy")</td>

                        <td>@listaDeCadastrosModel.DataDose1TripliceViral?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose2TripliceViral?.ToString("dd/MM/yyyy")</td>

                        <td>@listaDeCadastrosModel.DataDose1Covid?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose2Covid?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDose3Covid?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDoseReforco1Covid?.ToString("dd/MM/yyyy")</td>
                        <td>@listaDeCadastrosModel.DataDoseReforco2Covid?.ToString("dd/MM/yyyy")</td>

                        <td>@listaDeCadastrosModel.DataDoseUnicaFebreAmarela?.ToString("dd/MM/yyyy")</td>

                        <td>@listaDeCadastrosModel.DataDoseAnualInfluenza?.ToString("dd/MM/yyyy")</td>

                        <td>
                            @switch (listaDeCadastrosModel.SituacaoVacinacao)
                            {
                                case ControleVacinas___MVC_ASP_NET.Enums.SituacaoVacinacaoEnum.VacinacaoCompleta:
                                    @:<span style="color: green;">Vacinação Completa</span><br> @*color: green; "background-color: #90EE90; padding: 2px 4px;"*@
                                    @:@listaDeCadastrosModel.TotalDosesAplicadas Doses de @listaDeCadastrosModel.TotalTiposDeVacinas Vacinas Aplicadas
                                    break;
                                case ControleVacinas___MVC_ASP_NET.Enums.SituacaoVacinacaoEnum.VacinacaoAusente:
                                    @:<span style="color: red;">Vacinação Ausente</span><br> @* color: red; "background-color: #FF7F7F; padding: 2px 4px;"*@
                                    break;
                                case ControleVacinas___MVC_ASP_NET.Enums.SituacaoVacinacaoEnum.VacinacaoParcial:
                                    @:<span style="color: #ffc107;">Vacinação Parcial</span><br> @*  color: #ffc107; color: orange; color: darkorange; "background-color: #FFD700; padding: 2px 4px;"*@
                                    @:@listaDeCadastrosModel.TotalTiposDeVacinasAplicadas de @listaDeCadastrosModel.TotalTiposDeVacinas Vacinas aplicadas<br>
                                    @:@listaDeCadastrosModel.TotalDosesAplicadas de @listaDeCadastrosModel.TotalDoses Doses aplicadas
                                    @*@:@listaDeCadastrosModel.TotalTiposDeVacinasAplicadas de @listaDeCadastrosModel.TotalTiposDeVacinas Vacinas aplicadas (Faltando @listaDeCadastrosModel.TotalTiposDeVacinasFaltando)<br>
                                    @:@listaDeCadastrosModel.TotalDosesAplicadas de @listaDeCadastrosModel.TotalDoses Doses aplicadas (Faltando @listaDeCadastrosModel.TotalDosesFaltando)*@
                                    break;
                                default:
                                    @:Situação desconhecida
                                    break; 
                            }
                        </td>

                    </tr>
                    id_manual++;
                }
            }
            else
            {
                <tr class="odd"><td valign="top" colspan="26">Nenhum cadastro encontrado!</td></tr>
            }

            <!-- Mais linhas -->
@*             <tr id="nenhumResultadoRow" style="display:none;">
                <td colspan="7" class="text-center text-warning">Nenhum cadastro foi encontrado!</td>
            </tr> *@

        </tbody>
        <tfoot>
            <tr>
                @*<td colspan="7" scope="col">Balanço Geral de Vacinação dos Servidores</td>
                <td scope="col">Totais Servidores/Dose</td>*@
                <td colspan="2" scope="col"></td>
                <td colspan="2" scope="col">Total Servidores / DOSE</td>
                <td colspan="3" scope="col"></td>
                <td scope="col">@ViewBag.TotalDose1HepatiteB</td>
                <td scope="col">@ViewBag.TotalDose2HepatiteB</td>
                <td scope="col">@ViewBag.TotalDose3HepatiteB</td>
                <td scope="col">@ViewBag.TotalReforcoHepatiteB</td>                                                                      
                
                <td scope="col">@ViewBag.TotalExameAntiHBS</td>
                <td scope="col">@ViewBag.TotalResultadoAntiHBS</td>

                <td scope="col">@ViewBag.TotalDose1DifteriaTetano</td>
                <td scope="col">@ViewBag.TotalDose2DifteriaTetano</td>
                <td scope="col">@ViewBag.TotalDose3DifteriaTetano</td>
                <td scope="col">@ViewBag.TotalReforcoDifteriaTetano</td>

                <td scope="col">@ViewBag.TotalDose1TripliceViral</td>
                <td scope="col">@ViewBag.TotalDose2TripliceViral</td>

                <td scope="col">@ViewBag.TotalDose1Covid</td>
                <td scope="col">@ViewBag.TotalDose2Covid</td>
                <td scope="col">@ViewBag.TotalDose3Covid</td>
                <td scope="col">@ViewBag.TotalReforco1Covid</td>
                <td scope="col">@ViewBag.TotalReforco2Covid</td>
                <td scope="col">@ViewBag.TotalDoseUnicaFebreAmarela</td>
                <td scope="col">@ViewBag.TotalDoseAnualInfluenza</td>   
                <td colspan="1" scope="col"></td>
            </tr>
            <tr>
                @*<td colspan="7" scope="col">
                    @ViewBag.totalServidoresCadastrados Servidores,
                    @ViewBag.totalVacinadosCompletamente Completos,
                    @ViewBag.totalVacinadosParcialmente Parciais e
                    @ViewBag.totalNaoVacinados Não vacinados
                </td>
                <td colspan="1" scope="col">Totais Servidores/Vacina</td>*@
                <td colspan="2" scope="col"></td>
                <td colspan="2" scope="col">Total Servidores / VACINA</td>
                <td colspan="3" scope="col"></td>
                <td colspan="4" scope="col">@ViewBag.TotalHepatiteB</td>
                <td colspan="2" scope="col">@ViewBag.TotalExameAntiHBS</td>
                <td colspan="4" scope="col">@ViewBag.TotalDifteriaTetano</td>
                <td colspan="2" scope="col">@ViewBag.TotalTripliceViral</td>
                <td colspan="5" scope="col">@ViewBag.TotalCovid</td>
                <td colspan="1" scope="col">@ViewBag.TotalFebreAmarela</td>
                <td colspan="1" scope="col">@ViewBag.TotalInfluenza</td>
                <td colspan="1" scope="col"></td>
            </tr>
        </tfoot> 
    </table>
</div>

